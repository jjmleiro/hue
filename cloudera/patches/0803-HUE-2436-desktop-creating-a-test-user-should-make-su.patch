From b61e0790a8ff966436d70da9fbb44806f2504e27 Mon Sep 17 00:00:00 2001
From: Erick Tryzelaar <erick.tryzelaar@gmail.com>
Date: Thu, 5 Feb 2015 16:00:11 -0800
Subject: [PATCH 0803/1173] HUE-2436 [desktop] creating a test user should
 make sure to update is_superuser

---
 apps/zookeeper/src/zookeeper/rest.py             |    4 ++--
 desktop/core/src/desktop/lib/django_test_util.py |    6 +++++-
 2 files changed, 7 insertions(+), 3 deletions(-)

diff --git a/apps/zookeeper/src/zookeeper/rest.py b/apps/zookeeper/src/zookeeper/rest.py
index 473c317..ce80efa 100644
--- a/apps/zookeeper/src/zookeeper/rest.py
+++ b/apps/zookeeper/src/zookeeper/rest.py
@@ -15,9 +15,9 @@
 # See the License for the specific language governing permissions and
 # limitations under the License.
 
-import urllib2
-import urllib
 import json
+import urllib
+import urllib2
 
 from contextlib import contextmanager
 
diff --git a/desktop/core/src/desktop/lib/django_test_util.py b/desktop/core/src/desktop/lib/django_test_util.py
index 6070f30..70cab1c 100644
--- a/desktop/core/src/desktop/lib/django_test_util.py
+++ b/desktop/core/src/desktop/lib/django_test_util.py
@@ -56,10 +56,14 @@ def make_logged_in_client(username="test", password="test", is_superuser=True, r
     if recreate:
       user.delete()
       raise User.DoesNotExist
-  except User.DoesNotExist:    
+  except User.DoesNotExist:
     user = User.objects.create_user(username, username + '@localhost', password)
     user.is_superuser = is_superuser
     user.save()
+  else:
+    if user.is_superuser != is_superuser:
+      user.is_superuser = is_superuser
+      user.save()
 
   if groupname is not None:
     group, created = Group.objects.get_or_create(name=groupname)
-- 
1.7.9.5

