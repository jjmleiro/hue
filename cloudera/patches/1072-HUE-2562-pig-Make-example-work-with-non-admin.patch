From 4ca121f77f15a9d71344734a0d88ed8492512a02 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Fri, 13 Mar 2015 15:49:21 -0500
Subject: [PATCH 1072/1173] HUE-2562 [pig] Make example work with non admin

---
 .../templates/editor2/coordinator_editor.mako      |    2 +-
 apps/pig/src/pig/models.py                         |    3 +++
 2 files changed, 4 insertions(+), 1 deletion(-)

diff --git a/apps/oozie/src/oozie/templates/editor2/coordinator_editor.mako b/apps/oozie/src/oozie/templates/editor2/coordinator_editor.mako
index e15707c..f794037 100644
--- a/apps/oozie/src/oozie/templates/editor2/coordinator_editor.mako
+++ b/apps/oozie/src/oozie/templates/editor2/coordinator_editor.mako
@@ -266,7 +266,7 @@ ${ commonheader(_("Coordinator Editor"), "Oozie", user) | n,unicode }
                 <input type="text" class="filechooser-input dataset-input" data-bind="value: dataset_variable, filechooser: dataset_variable, attr: { placeholder:
                   dataset_type() == 'input_path' ? '${ _("Required data path dependency to start the worklow") }' :
                   dataset_type() == 'output_path' ? '${ _("Data path created by the workflow") }' :
-                  '${ _("e.g. 1, 2, 3, /data/logs, coord:nominalTime()") }' },
+                  'e.g. 1, 2, 3, /data/logs, ${"$"}{coord:nominalTime()}' },
                   typeahead: { target: dataset_variable, source: datasetTypeaheadSource, triggerOnFocus: true, multipleValues: true, multipleValuesSeparator: '/', multipleValuesExtractor: '/' }" style="margin-bottom:0; width: 380px" />
               </span>
 
diff --git a/apps/pig/src/pig/models.py b/apps/pig/src/pig/models.py
index fc99f5c..026ed14 100644
--- a/apps/pig/src/pig/models.py
+++ b/apps/pig/src/pig/models.py
@@ -87,6 +87,9 @@ class PigScript(Document):
 def create_or_update_script(id, name, script, user, parameters, resources, hadoopProperties, is_design=True):
   try:
     pig_script = PigScript.objects.get(id=id)
+    if id == '1100713': # Special case for the Example, just create an history
+      is_design = False
+      raise PigScript.DoesNotExist()
     pig_script.doc.get().can_write_or_exception(user)
   except PigScript.DoesNotExist:
     pig_script = PigScript.objects.create(owner=user, is_design=is_design)
-- 
1.7.9.5

