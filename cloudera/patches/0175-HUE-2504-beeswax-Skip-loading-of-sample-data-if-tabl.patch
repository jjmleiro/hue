From b3e00193a6edf454f4325c1e5499565130de28e5 Mon Sep 17 00:00:00 2001
From: Peter Slawski <petersla@amazon.com>
Date: Thu, 11 Dec 2014 15:57:22 -0800
Subject: [PATCH 0175/1173] HUE-2504 [beeswax] Skip loading of sample data if
 table already exists

---
 .../commands/beeswax_install_examples.py           |    6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/apps/beeswax/src/beeswax/management/commands/beeswax_install_examples.py b/apps/beeswax/src/beeswax/management/commands/beeswax_install_examples.py
index fa7e897..3f91cf5 100644
--- a/apps/beeswax/src/beeswax/management/commands/beeswax_install_examples.py
+++ b/apps/beeswax/src/beeswax/management/commands/beeswax_install_examples.py
@@ -120,8 +120,8 @@ class SampleTable(object):
       raise ValueError(msg)
 
   def install(self, django_user):
-    self.create(django_user)
-    self.load(django_user)
+    if self.create(django_user):
+      self.load(django_user)
 
   def create(self, django_user):
     """
@@ -135,6 +135,7 @@ class SampleTable(object):
       db.get_table('default', self.name)
       msg = _('Table "%(table)s" already exists.') % {'table': self.name}
       LOG.error(msg)
+      return False
     except Exception:
       query = hql_query(self.hql)
       try:
@@ -143,6 +144,7 @@ class SampleTable(object):
           msg = _('Error creating table %(table)s: Operation timeout.') % {'table': self.name}
           LOG.error(msg)
           raise InstallException(msg)
+        return True
       except Exception, ex:
         msg = _('Error creating table %(table)s: %(error)s.') % {'table': self.name, 'error': ex}
         LOG.error(msg)
-- 
1.7.9.5

