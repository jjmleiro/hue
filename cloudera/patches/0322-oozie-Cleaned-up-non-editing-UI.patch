From 18325f0d1bc8348902f47074a47aed60e49f0d82 Mon Sep 17 00:00:00 2001
From: Enrico Berti <hello@enricoberti.com>
Date: Tue, 25 Nov 2014 02:03:59 +0100
Subject: [PATCH 0322/1173] [oozie] Cleaned up non-editing UI

---
 .../oozie/templates/editor/workflow_editor.mako    |   10 +++++-----
 apps/oozie/static/css/workflow-editor.css          |    8 ++++++++
 2 files changed, 13 insertions(+), 5 deletions(-)

diff --git a/apps/oozie/src/oozie/templates/editor/workflow_editor.mako b/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
index 0e5dbb5..919773d 100644
--- a/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
+++ b/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
@@ -226,7 +226,7 @@ ${ commonheader(_("Workflow Editor"), "Oozie", user) | n,unicode }
 </div>
 
 <script type="text/html" id="column-template">
-  <div data-bind="css: klass" style="min-height: 50px !important;">
+  <div data-bind="css: klass() + (!$root.isEditing()?' card-column-disabled':'')" style="min-height: 50px !important;">
     <div data-bind="template: { name: 'row-template', data: oozieStartRow }"></div>
 
     <div class="container-fluid" data-bind="visible: $root.isEditing() && oozieRows().length > 0">
@@ -246,7 +246,7 @@ ${ commonheader(_("Workflow Editor"), "Oozie", user) | n,unicode }
 
 
 <script type="text/html" id="internal-column-template">
-  <div data-bind="css: klass" style="min-height: 50px !important;">
+  <div data-bind="css: klass() + (!$root.isEditing()?' card-column-disabled':'')" style="min-height: 50px !important;">
     <div class="container-fluid" data-bind="visible: $root.isEditing()">
       <div data-bind="visible: ! enableOozieDropOnBefore(), css: {'drop-target drop-target-disabled': true, 'is-editing': $root.isEditing}"></div>
       <div data-bind="visible: enableOozieDropOnBefore, css: {'drop-target': true, 'is-editing': $root.isEditing}, droppable: {enabled: $root.isEditing, onDrop: function(){ var _w = $root.addDraggedWidget($data, true); widgetDraggedAdditionalHandler(_w); } }"></div>
@@ -269,7 +269,7 @@ ${ commonheader(_("Workflow Editor"), "Oozie", user) | n,unicode }
           sortable: { template: 'widget-template', data: widgets, allowDrop: $root.isEditing() && widgets().length < 1, isEnabled: $root.isEditing() && widgets().length < 1,
           options: {'opacity': 0.7, 'placeholder': 'row-highlight', 'greedy': true,
               'stop': function(event, ui){},
-              'helper': function(event){lastWindowScrollPosition = $(window).scrollTop();  var _par = $('<div>');_par.addClass('card card-widget');var _title = $('<h2>');_title.addClass('card-heading simple');_title.text($(event.toElement).text());_title.appendTo(_par);_par.height(80);_par.width(180);return _par;}},
+              'helper': function(event){lastWindowScrollPosition = $(window).scrollTop(); var _par = $('<div>');_par.addClass('card card-widget');var _title = $('<h2>');_title.addClass('card-heading simple');_title.text($(event.toElement).text());_title.appendTo(_par);_par.height(80);_par.width(180);return _par;}},
               dragged: function(widget){widgetDraggedAdditionalHandler(widget)}}">
         </div>
       </div>
@@ -1554,10 +1554,10 @@ ${ commonheader(_("Workflow Editor"), "Oozie", user) | n,unicode }
 
 <div id="exposeOverlay"></div>
 
-<link rel="stylesheet" href="/oozie/static/css/workflow-editor.css">
 <link rel="stylesheet" href="/static/ext/css/hue-filetypes.css">
 <link rel="stylesheet" href="/static/ext/css/hue-charts.css">
 <link rel="stylesheet" href="/static/ext/chosen/chosen.min.css">
+<link rel="stylesheet" href="/oozie/static/css/workflow-editor.css">
 
 
 ${ dashboard.import_layout() }
@@ -1671,7 +1671,7 @@ ${ dashboard.import_bindings() }
       p2y: _toCenter.y,
       lineWidth: 2,
       size: 10,
-      strokeStyle: '#e5e5e5'
+      strokeStyle: viewModel.isEditing()?'#e5e5e5':'#dddddd'
     });
 
   }
diff --git a/apps/oozie/static/css/workflow-editor.css b/apps/oozie/static/css/workflow-editor.css
index 1eeb760..f585dda 100644
--- a/apps/oozie/static/css/workflow-editor.css
+++ b/apps/oozie/static/css/workflow-editor.css
@@ -370,4 +370,12 @@ em {
   top:0;
   left:0;
   z-index:1031;
+}
+
+.ui-sortable-disabled {
+  background-color: #f1f1f1!important;
+}
+
+.card-column-disabled {
+  background-color: #f1f1f1;
 }
\ No newline at end of file
-- 
1.7.9.5

