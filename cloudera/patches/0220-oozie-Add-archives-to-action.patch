From f3b5c6b940280ea7a2fd74e61f3132b5a1ce81c5 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Sat, 1 Nov 2014 14:32:30 +0100
Subject: [PATCH 0220/1173] [oozie] Add archives to action

---
 .../templates/editor/gen2/workflow-common.xml.mako |    2 +-
 .../oozie/templates/editor/workflow_editor.mako    |   32 ++++++++++++++++++--
 2 files changed, 30 insertions(+), 4 deletions(-)

diff --git a/apps/oozie/src/oozie/templates/editor/gen2/workflow-common.xml.mako b/apps/oozie/src/oozie/templates/editor/gen2/workflow-common.xml.mako
index 9afc266..feb2072 100644
--- a/apps/oozie/src/oozie/templates/editor/gen2/workflow-common.xml.mako
+++ b/apps/oozie/src/oozie/templates/editor/gen2/workflow-common.xml.mako
@@ -59,7 +59,7 @@
 <%def name="distributed_cache(files, archives)">
     % for f in files:
         % if f:
-            <file>${ filelink(f) }</file>
+            <file>${ filelink(f['value']) }</file>
         % endif
     % endfor
     % for a in archives:
diff --git a/apps/oozie/src/oozie/templates/editor/workflow_editor.mako b/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
index 484e9fb..6d80868 100644
--- a/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
+++ b/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
@@ -287,9 +287,35 @@ ${ dashboard.layout_skeleton() }
           <button data-bind="click: function(){ properties.properties.push({'name': '', 'value': ''}); }">
             <i class="fa fa-plus"></i>
           </button>       
-          <br/>          
-          parameters <input type="text" data-bind="value: properties.parameters" /></br>
-          archives <input type="text" data-bind="value: properties.archives" /></br>
+          <br/>                    
+          ${ _('Archives') }   
+          <ul data-bind="foreach: properties.archives">
+            <li>
+              <input data-bind="value: name"/>
+              <a href="#" data-bind="click: function(){ $parent.properties.archives.remove(this); }">
+                <i class="fa fa-minus"></i>
+              </a>
+            </li>
+          </ul>
+          <button data-bind="click: function(){ properties.archives.push({'name': ''}); }">
+            <i class="fa fa-plus"></i>
+          </button>      
+          <br/>    
+          
+          ${ _('Parameters') }   
+          <ul data-bind="foreach: properties.parameters">
+            <li>
+              <input data-bind="value: value"/>
+              <a href="#" data-bind="click: function(){ $parent.properties.parameters.remove(this); }">
+                <i class="fa fa-minus"></i>
+              </a>
+            </li>
+          </ul>
+          <button data-bind="click: function(){ properties.parameters.push({'value': ''}); }">
+            <i class="fa fa-plus"></i>
+          </button>       
+          </br>          
+          
           sla <input type="text" data-bind="value: properties.sla" /></br>
           credentials <input type="text" data-bind="value: properties.credentials" /></br>
         </div>
-- 
1.7.9.5

