From d309b0247385c56ca326782bf1795280cff14cba Mon Sep 17 00:00:00 2001
From: Enrico Berti <hello@enricoberti.com>
Date: Tue, 3 Feb 2015 19:28:07 +0100
Subject: [PATCH 0744/1173] [spark] Restyle medium toolbar and make text
 widgets always editable

---
 apps/spark/src/spark/templates/editor.mako |    6 +++---
 apps/spark/static/css/spark.css            |   17 ++++++++++-------
 2 files changed, 13 insertions(+), 10 deletions(-)

diff --git a/apps/spark/src/spark/templates/editor.mako b/apps/spark/src/spark/templates/editor.mako
index 7957236..a767881 100644
--- a/apps/spark/src/spark/templates/editor.mako
+++ b/apps/spark/src/spark/templates/editor.mako
@@ -590,8 +590,8 @@ ${ commonheader(_('Query'), app_name, user, "68px") | n,unicode }
       </div>
 
       <div data-bind="visible: type() == 'text'" class="snippet-body">
-        <div data-bind="html: statement_raw, visible: ! $root.isEditing()" class="text-snippet"></div>
-        <div data-bind="attr:{'id': 'editor_'+id()}, html: statement_raw, value: statement_raw, medium: {}, visible: $root.isEditing()" class="text-snippet"></div>
+        ##<div data-bind="html: statement_raw, visible: ! $root.isEditing()" class="text-snippet"></div>
+        <div data-bind="attr:{'id': 'editor_'+id()}, html: statement_raw, value: statement_raw, medium: {}" class="text-snippet"></div>
       </div>
     </div>
   </div>
@@ -653,7 +653,7 @@ ${ commonheader(_('Query'), app_name, user, "68px") | n,unicode }
           firstHeader: 'h2',
           secondHeader: 'h3'
       });
-      $(element).on('input', function() {
+      $(element).on('blur', function() {
         allBindings().value($(element).html())
       });
     }
diff --git a/apps/spark/static/css/spark.css b/apps/spark/static/css/spark.css
index cd3b8cc..85f9c38 100644
--- a/apps/spark/static/css/spark.css
+++ b/apps/spark/static/css/spark.css
@@ -176,13 +176,6 @@
   white-space: nowrap;
 }
 
-[contenteditable] {
-  min-height: 200px;
-  border: 1px solid #DDD;
-  border-top: none;
-  padding: 10px;
-}
-
 [contenteditable]:focus {
   outline:none;
 }
@@ -268,3 +261,13 @@ h1.empty {
   margin-left: 0;
   margin-right: 4px;
 }
+
+.medium-editor-toolbar li button {
+  padding: 0!important;
+  height: 40px!important;
+  min-width: 40px!important;
+}
+
+.medium-toolbar-arrow-under:after {
+  top: 40px!important;
+}
-- 
1.7.9.5

