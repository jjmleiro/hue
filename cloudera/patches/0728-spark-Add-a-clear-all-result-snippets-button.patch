From 72dee7a3f1361c96164e7431d053bc629454ec03 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Sun, 1 Feb 2015 08:53:37 +0900
Subject: [PATCH 0728/1173] [spark] Add a clear all result snippets button

---
 apps/spark/src/spark/templates/editor.mako |   26 ++++++++++++++++++++++----
 apps/spark/static/js/spark.ko.js           |    6 ++++++
 2 files changed, 28 insertions(+), 4 deletions(-)

diff --git a/apps/spark/src/spark/templates/editor.mako b/apps/spark/src/spark/templates/editor.mako
index 5baa295..6fdbc6b 100644
--- a/apps/spark/src/spark/templates/editor.mako
+++ b/apps/spark/src/spark/templates/editor.mako
@@ -110,10 +110,28 @@ ${ commonheader(_('Query'), app_name, user, "68px") | n,unicode }
 
 <div class="search-bar">
   <div class="pull-right" style="padding-right:50px">
-    <a title="${ _('Execute all') }" rel="tooltip" data-placement="bottom" data-bind="click: true, css: {'btn': true}">
-      <i class="fa fa-play"></i>
-    </a>
-    
+  
+     <div class="btn-group" data-bind="visible: isEditing">
+       <button class="btn dropdown-toggle" data-toggle="dropdown">
+         <i class="fa fa-check-square-o"></i>
+         <i class="fa fa-caret-down"></i>
+       </button>
+       <ul class="dropdown-menu">
+         <li>
+           <a href="javascript:void(0)" data-bind="click: function() { $root.selectedNotebook().clearResults() }">
+             <i class="fa fa-play"></i> ${ _('Execute all snippets') }
+           </a>
+         </li>
+         <li>
+           <a href="javascript:void(0)" data-bind="click: function() { $root.selectedNotebook().clearResults() }">
+             <i class="fa fa-eraser"></i> ${ _('Clear all results') }
+           </a>
+        </li>
+      </ul>
+    </div>  
+  
+   &nbsp;&nbsp;&nbsp;
+  
     <a title="${ _('Edit') }" rel="tooltip" data-placement="bottom" data-bind="click: toggleEditing, css: {'btn': true, 'btn-inverse': isEditing}">
       <i class="fa fa-pencil"></i>
     </a>
diff --git a/apps/spark/static/js/spark.ko.js b/apps/spark/static/js/spark.ko.js
index 93575f6..4e66d5a 100644
--- a/apps/spark/static/js/spark.ko.js
+++ b/apps/spark/static/js/spark.ko.js
@@ -583,6 +583,12 @@ var Notebook = function (vm, notebook) {
       });
 	}
   };
+  
+  self.clearResults = function () {
+	$.each(self.snippets(), function(index, snippet) {
+      snippet.result.clear();
+	});
+  };
 }
 
 
-- 
1.7.9.5

