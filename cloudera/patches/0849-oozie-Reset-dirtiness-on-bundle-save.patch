From 638502eb9965aafcc944fc74dd6815e19c97b193 Mon Sep 17 00:00:00 2001
From: Enrico Berti <hello@enricoberti.com>
Date: Tue, 17 Feb 2015 22:46:06 +0100
Subject: [PATCH 0849/1173] [oozie] Reset dirtiness on bundle save

---
 .../src/oozie/templates/editor2/bundle_editor.mako |    2 ++
 apps/oozie/static/js/bundle-editor.ko.js           |    1 +
 2 files changed, 3 insertions(+)

diff --git a/apps/oozie/src/oozie/templates/editor2/bundle_editor.mako b/apps/oozie/src/oozie/templates/editor2/bundle_editor.mako
index fe5db6a..ba96ac6 100644
--- a/apps/oozie/src/oozie/templates/editor2/bundle_editor.mako
+++ b/apps/oozie/src/oozie/templates/editor2/bundle_editor.mako
@@ -225,6 +225,8 @@ ${ dashboard.import_bindings() }
   var viewModel = new BundleEditorViewModel(${ bundle_json | n,unicode }, ${ coordinators_json | n,unicode }, ${ can_edit_json | n,unicode });
   ko.applyBindings(viewModel, $("#editor")[0]);
 
+  viewModel.bundle.tracker().markCurrentStateAsClean();
+
   var shareViewModel = initSharing("#documentShareModal");
   shareViewModel.setDocId(${ doc1_id });
 
diff --git a/apps/oozie/static/js/bundle-editor.ko.js b/apps/oozie/static/js/bundle-editor.ko.js
index ec540eb..59a1370 100644
--- a/apps/oozie/static/js/bundle-editor.ko.js
+++ b/apps/oozie/static/js/bundle-editor.ko.js
@@ -118,6 +118,7 @@ var BundleEditorViewModel = function (bundle_json, coordinators_json, can_edit_j
     }, function (data) {
       if (data.status == 0) {
         self.bundle.id(data.id);
+        self.bundle.tracker().markCurrentStateAsClean();
         $(document).trigger("info", data.message);
         if (window.location.search.indexOf("bundle") == -1) {
           window.location.hash = '#bundle=' + data.id;
-- 
1.7.9.5

