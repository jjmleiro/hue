From dc2c6119b945eee1d5129a9904d0900eca41caea Mon Sep 17 00:00:00 2001
From: Erick Tryzelaar <erickt@cloudera.com>
Date: Wed, 11 Mar 2015 21:51:41 -0700
Subject: [PATCH 1047/1173] [livy] Update spark version to
 1.3.0-cdh5.4.0-SNAPSHOT

---
 apps/spark/java/livy-repl/pom.xml |   39 +++++++++++++++++++++++++++++++------
 maven/pom.xml                     |    5 -----
 2 files changed, 33 insertions(+), 11 deletions(-)

diff --git a/apps/spark/java/livy-repl/pom.xml b/apps/spark/java/livy-repl/pom.xml
index c60f5cd..5dc6f12 100644
--- a/apps/spark/java/livy-repl/pom.xml
+++ b/apps/spark/java/livy-repl/pom.xml
@@ -22,10 +22,43 @@
         </dependency>
 
         <dependency>
+            <groupId>org.scalatra</groupId>
+            <artifactId>scalatra-scalatest_${scala.binary.version}</artifactId>
+            <scope>test</scope>
+        </dependency>
+
+        <dependency>
+            <groupId>org.apache.spark</groupId>
+            <artifactId>spark-assembly_${scala.binary.version}</artifactId>
+            <version>${spark.version}</version>
+            <scope>test</scope>
+            <exclusions>
+                <exclusion>
+                    <groupId>org.apache.httpcomponents</groupId>
+                    <artifactId>httpclient</artifactId>
+                </exclusion>
+                <exclusion>
+                    <groupId>org.apache.httpcomponents</groupId>
+                    <artifactId>httpcore</artifactId>
+                </exclusion>
+            </exclusions>
+        </dependency>
+
+        <dependency>
             <groupId>org.apache.spark</groupId>
             <artifactId>spark-core_${scala.binary.version}</artifactId>
             <version>${spark.version}</version>
             <scope>provided</scope>
+            <exclusions>
+                <exclusion>
+                    <groupId>org.apache.httpcomponents</groupId>
+                    <artifactId>httpclient</artifactId>
+                </exclusion>
+                <exclusion>
+                    <groupId>org.apache.httpcomponents</groupId>
+                    <artifactId>httpcore</artifactId>
+                </exclusion>
+            </exclusions>
         </dependency>
 
         <dependency>
@@ -42,12 +75,6 @@
         </dependency>
 
         <dependency>
-            <groupId>org.scalatra</groupId>
-            <artifactId>scalatra-scalatest_${scala.binary.version}</artifactId>
-            <scope>test</scope>
-        </dependency>
-
-        <dependency>
             <groupId>net.sf.py4j</groupId>
             <artifactId>py4j</artifactId>
             <version>0.8.2.1</version>
diff --git a/maven/pom.xml b/maven/pom.xml
index 472e08c..98123e2 100644
--- a/maven/pom.xml
+++ b/maven/pom.xml
@@ -45,12 +45,7 @@
   <properties>
     <hadoop-mr1.version>${cdh.mr1.version}</hadoop-mr1.version>
     <hadoop.version>${cdh.hadoop.version}</hadoop.version>
-    <!--
-    FIXME: We can't use the upstream version yet because spark-1.2.0 does not
-    include the spark-repl.
     <spark.version>${cdh.spark.version}</spark.version>
-    -->
-    <spark.version>1.2.1</spark.version>
     <slf4j.version>1.6.1</slf4j.version>
     <commons-logging.version>1.0.4</commons-logging.version>
     <thrift.version>0.9.0</thrift.version>
-- 
1.7.9.5

