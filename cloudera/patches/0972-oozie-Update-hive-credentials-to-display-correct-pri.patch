From 406f40b00e4b5bac7da18911761b68b0dfac36dc Mon Sep 17 00:00:00 2001
From: krish <krish@cloudera.com>
Date: Mon, 2 Mar 2015 15:58:11 -0800
Subject: [PATCH 0972/1173] [oozie] Update hive credentials to display correct
 principal when HS2 and HMS are on different hosts

---
 desktop/libs/liboozie/src/liboozie/credentials.py |    4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/desktop/libs/liboozie/src/liboozie/credentials.py b/desktop/libs/liboozie/src/liboozie/credentials.py
index 60841d8..69c3b68 100644
--- a/desktop/libs/liboozie/src/liboozie/credentials.py
+++ b/desktop/libs/liboozie/src/liboozie/credentials.py
@@ -49,7 +49,7 @@ class Credentials(object):
 
   def get_properties(self, metastore=None):
     credentials = {}
-    from beeswax import hive_site
+    from beeswax import hive_site, conf
 
     if metastore is None:
       metastore = hive_site.get_metastore()
@@ -70,7 +70,7 @@ class Credentials(object):
       'xml_name': self.hiveserver2_name,
       'properties': [
          ('hive2.jdbc.url', hive_site.hiveserver2_jdbc_url()),
-         ('hive2.server.principal', metastore.get('kerberos_principal')),
+         ('hive2.server.principal', hive_site.get_hiveserver2_kerberos_principal(conf.HIVE_SERVER_HOST.get())),
       ]
     }
 
-- 
1.7.9.5

