From 9a0368f20ac8298a56dd51b51cc20db890f76c22 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Mon, 27 Oct 2014 18:02:32 -0700
Subject: [PATCH 0079/1173] HUE-2438 [core] Disable SSLv3 for Poodle
 vulnerability

Also disable SSLv2.
https://pythonhosted.org/pyOpenSSL/api/ssl.html#OpenSSL.SSL.OP_NO_SSLv2
---
 desktop/core/src/desktop/lib/wsgiserver.py |    1 +
 1 file changed, 1 insertion(+)

diff --git a/desktop/core/src/desktop/lib/wsgiserver.py b/desktop/core/src/desktop/lib/wsgiserver.py
index af21fc2..e771cae 100644
--- a/desktop/core/src/desktop/lib/wsgiserver.py
+++ b/desktop/core/src/desktop/lib/wsgiserver.py
@@ -1667,6 +1667,7 @@ class CherryPyWSGIServer(object):
             ctx.set_cipher_list(self.ssl_cipher_list)
             ctx.use_privatekey_file(self.ssl_private_key)
             ctx.use_certificate_file(self.ssl_certificate)
+            ctx.set_options(SSL.OP_NO_SSLv2 | SSL.OP_NO_SSLv3)
             self.socket = SSLConnection(ctx, self.socket)
             self.populate_ssl_environ()
             
-- 
1.7.9.5

