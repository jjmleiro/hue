From e3ee463e012bd32208577b21274291f8c1f923f5 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Wed, 29 Apr 2015 17:17:01 -0700
Subject: [PATCH 1162/1173] HUE-2720 [oozie] Intermittent 500s when trying to
 view oozie workflow history v1

---
 .../editor/gen/workflow-graph-status.xml.mako      |    3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/apps/oozie/src/oozie/templates/editor/gen/workflow-graph-status.xml.mako b/apps/oozie/src/oozie/templates/editor/gen/workflow-graph-status.xml.mako
index 8921b29..ad4510a 100644
--- a/apps/oozie/src/oozie/templates/editor/gen/workflow-graph-status.xml.mako
+++ b/apps/oozie/src/oozie/templates/editor/gen/workflow-graph-status.xml.mako
@@ -19,6 +19,7 @@
 <%namespace name="utils" file="../../utils.inc.mako" />
 
 <%!
+  import re
   from django.utils.translation import ugettext as _
 %>
 
@@ -47,7 +48,7 @@
 
 <%def name="get_content(form, action, control, inverse=False)">
   <div class="row-fluid">
-    % if action and action.externalId:
+    % if action and action.externalId and re.match('\\w+', action.externalId):
       <div style="text-align:left; padding:10px;border:1px solid #DDD; border-top:0" class="span12">
           <div style="font-size: 30px; margin-top:14px" class="pull-right"><a href="${ url('jobbrowser.views.job_single_logs', job=action.externalId) }" title="${ _('View the logs') }" rel="tooltip" data-row-selector-exclude="true"><i class="fa fa-tasks"></i></a></div>
           <h4><a href="${ action.get_absolute_url() }" title="${ _('View workflow action') }" rel="tooltip">${ form.instance.__unicode__() }</a></h4>
-- 
1.7.9.5

