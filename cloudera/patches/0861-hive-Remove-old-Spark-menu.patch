From c023e5ff97fd3155606fa7458c60aecab529dd28 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Wed, 18 Feb 2015 18:04:02 -0800
Subject: [PATCH 0861/1173] [hive] Remove old Spark menu

Disable 'Query Editor' from being translated
---
 apps/beeswax/src/beeswax/templates/layout.mako     |   32 +-------------------
 apps/beeswax/src/beeswax/tests.py                  |    4 +--
 .../core/src/desktop/templates/common_header.mako  |    2 +-
 3 files changed, 4 insertions(+), 34 deletions(-)

diff --git a/apps/beeswax/src/beeswax/templates/layout.mako b/apps/beeswax/src/beeswax/templates/layout.mako
index 8c47c6d..5de73b0 100644
--- a/apps/beeswax/src/beeswax/templates/layout.mako
+++ b/apps/beeswax/src/beeswax/templates/layout.mako
@@ -13,10 +13,7 @@
 ## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 ## See the License for the specific language governing permissions and
 ## limitations under the License.
-##
-##
-## no spaces in this method please; we're declaring a CSS class, and ART uses this value for stuff, and it splits on spaces, and
-## multiple spaces and line breaks cause issues
+
 <%!
 from django.utils.translation import ugettext as _
 
@@ -28,32 +25,6 @@ def is_selected(section, matcher):
 %>
 
 <%def name="menubar(section='')">
-  % if app_name == 'spark':
-  ## Duplication from spark common.mako!
-  <div class="navbar navbar-inverse navbar-fixed-top">
-    <div class="navbar-inner">
-      <div class="container-fluid">
-        <div class="nav-collapse">
-          <ul class="nav">
-            <li class="currentApp">
-              <a href="/spark">
-                <img src="/spark/static/art/icon_spark_48.png" class="app-icon" />
-                ${ _('Spark Igniter') }
-              </a>
-            </li>
-            <li class="${is_selected(section, 'query')}"><a href="${ url('spark:editor') }">${_('Editor')}</a></li>
-            ##<li class="${is_selected(section, 'my queries')}"><a href="${ url(app_name + ':my_queries') }">${_('My Queries')}</a></li>
-            <li class="${is_selected(section, 'saved queries')}"><a href="${ url('spark:list_designs') }">${_('Applications')}</a></li>
-            ##<li class="${is_selected(section, 'history')}"><a href="${ url('spark:list_query_history') }">${_('History')}</a></li>
-            <li class="${is_selected(section, 'jobs')}"><a href="${ url('spark:list_jobs') }">${_('Dashboard')}</a></li>
-            <li class="${is_selected(section, 'contexts')}"><a href="${ url('spark:list_contexts') }">${_('Contexts')}</a></li>
-            <li class="${is_selected(section, 'applications')}"><a href="${ url('spark:list_applications') }">${_('Uploads')}</a></li>
-          </ul>
-        </div>
-      </div>
-    </div>
-  </div>
-  % else:
   <div class="navbar navbar-inverse navbar-fixed-top">
       <div class="navbar-inner">
         <div class="container-fluid">
@@ -82,7 +53,6 @@ def is_selected(section, matcher):
         </div>
       </div>
   </div>
-  % endif
 </%def>
 
 <%def name="metastore_menubar()">
diff --git a/apps/beeswax/src/beeswax/tests.py b/apps/beeswax/src/beeswax/tests.py
index 122749d..e9ff09f 100644
--- a/apps/beeswax/src/beeswax/tests.py
+++ b/apps/beeswax/src/beeswax/tests.py
@@ -477,8 +477,8 @@ for x in sys.stdin:
       result_holder[i] = response
       lock.release()
       LOG.info("Finished: " + str(i))
-    except:
-      LOG.exception("Saw exception in child thread.")
+    except Exception, e:
+      LOG.exception("Saw exception in child thread: %s" % e)
 
   def test_multiple_statements_no_result_set(self):
     hql = """
diff --git a/desktop/core/src/desktop/templates/common_header.mako b/desktop/core/src/desktop/templates/common_header.mako
index d562feb..56482c7 100644
--- a/desktop/core/src/desktop/templates/common_header.mako
+++ b/desktop/core/src/desktop/templates/common_header.mako
@@ -360,7 +360,7 @@ from django.utils.translation import ugettext as _
        %>
        % if query_apps[1] > 1:
        <li class="dropdown">
-         <a title="${_('Query data')}" rel="navigator-tooltip" href="#" data-toggle="dropdown" class="dropdown-toggle">${_('Query Editors')} <b class="caret"></b></a>
+         <a title="${_('Query data')}" rel="navigator-tooltip" href="#" data-toggle="dropdown" class="dropdown-toggle">Query Editors <b class="caret"></b></a>
          <ul role="menu" class="dropdown-menu">
            % if 'beeswax' in apps:
            <li><a href="/${apps['beeswax'].display_name}"><img src="${ apps['beeswax'].icon_path }" class="app-icon"/> ${_('Hive')}</a></li>
-- 
1.7.9.5

