From c8fcb8f618a54493cdd112f3e36c749bebbad28f Mon Sep 17 00:00:00 2001
From: Erick Tryzelaar <erick.tryzelaar@gmail.com>
Date: Thu, 15 Jan 2015 18:44:25 -0800
Subject: [PATCH 0786/1173] HUE-2436 [desktop] Fix running ./build/env/bin/hue
 commands

---
 desktop/core/src/desktop/manage_entry.py |   13 +++++--------
 1 file changed, 5 insertions(+), 8 deletions(-)

diff --git a/desktop/core/src/desktop/manage_entry.py b/desktop/core/src/desktop/manage_entry.py
index 76809c4..b5ed489 100644
--- a/desktop/core/src/desktop/manage_entry.py
+++ b/desktop/core/src/desktop/manage_entry.py
@@ -34,14 +34,11 @@ def _deprecation_check(arg0):
 def entry():
   _deprecation_check(sys.argv[0])
 
-  from django.core.management import execute_manager, find_commands, find_management_module
+  from django.core.management import execute_from_command_line, find_commands, find_management_module
   from django.core.management import LaxOptionParser
   from django.core.management.base import BaseCommand
-  try:
-    from desktop import settings, appmanager
-  except ImportError, ie:
-    traceback.print_exc()
-    sys.exit(1)
+
+  os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'desktop.settings')
 
   # What's the subcommand being run?
   # This code uses the same logic from django.core.management to handle command args
@@ -55,9 +52,9 @@ def entry():
 
   # Let django handle the normal execution
   if os.getenv("DESKTOP_PROFILE"):
-    _profile(prof_id, lambda: execute_manager(settings))
+    _profile(prof_id, lambda: execute_from_command_line(sys.argv))
   else:
-    execute_manager(settings)
+    execute_from_command_line(sys.argv)
 
 
 def _profile(prof_id, func):
-- 
1.7.9.5

