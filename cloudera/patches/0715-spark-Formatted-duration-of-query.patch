From 07f676d956c6a1180249d23b3c045485715f3c8f Mon Sep 17 00:00:00 2001
From: Enrico Berti <hello@enricoberti.com>
Date: Thu, 29 Jan 2015 05:02:23 +0100
Subject: [PATCH 0715/1173] [spark] Formatted duration of query

---
 apps/spark/src/spark/templates/editor.mako |   14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/apps/spark/src/spark/templates/editor.mako b/apps/spark/src/spark/templates/editor.mako
index 7e435a9..e40be15 100644
--- a/apps/spark/src/spark/templates/editor.mako
+++ b/apps/spark/src/spark/templates/editor.mako
@@ -381,7 +381,7 @@ ${ commonheader(_('Query'), app_name, user, "68px") | n,unicode }
           </div>
 
           <div class="pull-right">
-            <strong class="muted" data-bind="visible: type() != 'text' && status() != 'ready' && status() != 'loading', text: result.executionTime"></strong>
+            <strong class="muted" data-bind="visible: type() != 'text' && status() != 'ready' && status() != 'loading', text: result.executionTime().toHHMMSS()"></strong>
             
             &nbsp;
             
@@ -582,6 +582,18 @@ ${ commonheader(_('Query'), app_name, user, "68px") | n,unicode }
     baseURL: "${url('beeswax:api_autocomplete_databases')}"
   });
 
+  Number.prototype.toHHMMSS = function () {
+    var _s = this;
+    var _ms = _s % 1000;
+    _s = (_s - _ms) / 1000;
+    var _secs = _s % 60;
+    _s = (_s - _secs) / 60;
+    var _mins = _s % 60;
+    var _hrs = (_s - _mins) / 60;
+
+    return (_hrs > 0 ? _hrs + "h, " : "") + (_mins > 0 ? _mins + "m, " : "") + _secs + "." + _ms + "s";
+  }
+
   $.scrollbarWidth = function() {
     var _parent, _child, _width;
     _parent = $('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo('body');
-- 
1.7.9.5

