From 6a89d3d583df1319bcced5a8a39a59a546d4a2d6 Mon Sep 17 00:00:00 2001
From: Romain Rigaux <romain@cloudera.com>
Date: Wed, 7 Jan 2015 12:22:17 -0800
Subject: [PATCH 0406/1173] [oozie] Bump version of Oozie workflows to 0.5

---
 apps/oozie/src/oozie/models2.py                    |    2 +-
 .../oozie/templates/editor/workflow_editor.mako    |    3 +++
 apps/oozie/static/js/workflow-editor.ko.js         |    2 ++
 3 files changed, 6 insertions(+), 1 deletion(-)

diff --git a/apps/oozie/src/oozie/models2.py b/apps/oozie/src/oozie/models2.py
index 0455f63..cf1235d 100644
--- a/apps/oozie/src/oozie/models2.py
+++ b/apps/oozie/src/oozie/models2.py
@@ -115,7 +115,7 @@ class Workflow(Job):
                   "description": "",
                   "job_xml": "",
                   "sla_enabled": False,
-                  "schema_version": "uri:oozie:workflow:0.4",
+                  "schema_version": "uri:oozie:workflow:0.5",
                   "sla_workflow_enabled": False,
                   "credentials": [],
                   "properties": [],
diff --git a/apps/oozie/src/oozie/templates/editor/workflow_editor.mako b/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
index 18c4125..06faa98 100644
--- a/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
+++ b/apps/oozie/src/oozie/templates/editor/workflow_editor.mako
@@ -1711,6 +1711,9 @@ ${ commonheader(_("Workflow Editor"), "Oozie", user, "40px") | n,unicode }
         <i class="fa fa-fw fa-long-arrow-down"></i>
       </a>
 
+      <h4>${ _("Version") }</h4>
+      <select class="input-xlarge" data-bind="value: $root.workflow.properties.schema_version, options: $root.workflow.versions"></select>
+
       <h4>${ _("Job XML") }</h4>
       <input type="text" class="input-xlarge filechooser-input" data-bind="filechooser: $root.workflow.properties.job_xml, filechooserOptions: globalFilechooserOptions"/>
 
diff --git a/apps/oozie/static/js/workflow-editor.ko.js b/apps/oozie/static/js/workflow-editor.ko.js
index 8daaf95..9728958 100644
--- a/apps/oozie/static/js/workflow-editor.ko.js
+++ b/apps/oozie/static/js/workflow-editor.ko.js
@@ -160,7 +160,9 @@ var Workflow = function (vm, workflow) {
 
   self.properties = ko.mapping.fromJS(typeof workflow.properties != "undefined" && workflow.properties != null ? workflow.properties : {});
   self.nodes = ko.observableArray([]);
+
   self.movedNode = null;
+  self.versions = ko.mapping.fromJS(['uri:oozie:workflow:0.4', 'uri:oozie:workflow:0.4.5', 'uri:oozie:workflow:0.5']) 
 
   self.nodeIds = ko.computed(function () {
     var mapping = [];
-- 
1.7.9.5

