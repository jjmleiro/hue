From 8396d36cbc422371bf2af9956d57a72754b1f49f Mon Sep 17 00:00:00 2001
From: Ivan Orlov <ivanorlo@amazon.com>
Date: Wed, 8 Oct 2014 12:40:13 -0700
Subject: [PATCH 0011/1173] HUE-2383 [filebrowser] Close file handle in
 read_contents properly

---
 apps/filebrowser/src/filebrowser/views.py |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/apps/filebrowser/src/filebrowser/views.py b/apps/filebrowser/src/filebrowser/views.py
index 3454e69..2bb58ad 100644
--- a/apps/filebrowser/src/filebrowser/views.py
+++ b/apps/filebrowser/src/filebrowser/views.py
@@ -621,6 +621,7 @@ def read_contents(codec_type, path, fs, offset, length):
        Returns: A tuple of codec_type, offset, length and contents read.
     """
     contents = ''
+    fhandle = None
 
     try:
         fhandle = fs.open(path)
@@ -660,7 +661,8 @@ def read_contents(codec_type, path, fs, offset, length):
             contents = _read_simple(fhandle, path, offset, length, stats)
 
     finally:
-        fhandle.close()
+        if fhandle:
+            fhandle.close()
 
     return (codec_type, offset, length, contents)
 
-- 
1.7.9.5

