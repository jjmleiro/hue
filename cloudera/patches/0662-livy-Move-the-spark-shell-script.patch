From 80201ad16af4eacbc51b3768a927755b8b28a6f3 Mon Sep 17 00:00:00 2001
From: Erick Tryzelaar <erickt@cloudera.com>
Date: Fri, 23 Jan 2015 18:26:19 -0800
Subject: [PATCH 0662/1173] [livy] Move the spark-shell script

---
 apps/spark/java/bin/spark-shell                    |   27 ++++++++++++++++++++
 .../hue/livy/server/SparkProcessSession.scala      |    2 +-
 apps/spark/spark-shell                             |    8 ------
 3 files changed, 28 insertions(+), 9 deletions(-)
 create mode 100755 apps/spark/java/bin/spark-shell
 delete mode 100755 apps/spark/spark-shell

diff --git a/apps/spark/java/bin/spark-shell b/apps/spark/java/bin/spark-shell
new file mode 100755
index 0000000..bd34824
--- /dev/null
+++ b/apps/spark/java/bin/spark-shell
@@ -0,0 +1,27 @@
+#!/bin/bash
+# Licensed to Cloudera, Inc. under one
+# or more contributor license agreements.  See the NOTICE file
+# distributed with this work for additional information
+# regarding copyright ownership.  Cloudera, Inc. licenses this file
+# to you under the Apache License, Version 2.0 (the
+# "License"); you may not use this file except in compliance
+# with the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+#
+# Runs spark shell server.
+
+set -e
+
+export LIVY_HOME=$(cd $(dirname $0)/.. && pwd)
+
+exec java \
+	-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5006 \
+	-cp "$LIVY_HOME/livy-repl/target/lib/*:$LIVY_HOME/livy-repl/target/livy-repl-3.7.0-SNAPSHOT.jar" \
+	com.cloudera.hue.livy.repl.Main -usejavacp "$@"
diff --git a/apps/spark/java/livy-server/src/main/scala/com/cloudera/hue/livy/server/SparkProcessSession.scala b/apps/spark/java/livy-server/src/main/scala/com/cloudera/hue/livy/server/SparkProcessSession.scala
index f71326f..14309fa 100644
--- a/apps/spark/java/livy-server/src/main/scala/com/cloudera/hue/livy/server/SparkProcessSession.scala
+++ b/apps/spark/java/livy-server/src/main/scala/com/cloudera/hue/livy/server/SparkProcessSession.scala
@@ -6,7 +6,7 @@ import scala.io.Source
 
 object SparkProcessSession {
   val LIVY_HOME = System.getenv("LIVY_HOME")
-  val SPARK_SHELL = LIVY_HOME + "/spark-shell"
+  val SPARK_SHELL = LIVY_HOME + "/bin/spark-shell"
 
   def create(id: String): Session = {
     val (process, port) = startProcess()
diff --git a/apps/spark/spark-shell b/apps/spark/spark-shell
deleted file mode 100755
index 6da0513..0000000
--- a/apps/spark/spark-shell
+++ /dev/null
@@ -1,8 +0,0 @@
-#!/bin/bash
-
-cd `dirname $0`
-
-exec java \
-	-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5006 \
-	-cp "java/livy-repl/target/lib/*:java/livy-repl/target/livy-repl-3.7.0-SNAPSHOT.jar" \
-	com.cloudera.hue.livy.repl.Main -usejavacp "$@" 2>/dev/null
-- 
1.7.9.5

